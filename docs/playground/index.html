<!DOCTYPE html>
<!--
  Copyright (c) 2025-present Cesar Saguier Antebi
  
  This file is part of AIGEN Blockchain.
  
  Licensed under the Business Source License 1.1 (the "License");
  you may not use this file except in compliance with the License.
  You may obtain a copy of the License at the root of this repository.
  
  Unless required by applicable law or agreed to in writing, software
  distributed under the License is distributed on an "AS IS" BASIS,
  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  See the License for the specific language governing permissions and
  limitations under the License.
-->
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AIGEN AI Playground</title>
    <link rel="stylesheet" href="style.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism-tomorrow.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/marked/11.0.0/marked.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-javascript.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-python.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-bash.min.js"></script>
</head>
<body>
    <div class="app-container">
        <!-- Header -->
        <header class="header">
            <div class="header-left">
                <div class="logo">
                    <h1>AIGEN</h1>
                    <span class="logo-subtitle">AI Playground</span>
                </div>
            </div>
            <div class="header-center">
                <div class="connection-status">
                    <span class="status-indicator" id="connectionStatus"></span>
                    <span class="status-text" id="connectionText">Connecting...</span>
                </div>
            </div>
            <div class="header-right">
                <div class="quota-display">
                    <span class="quota-label">Quota:</span>
                    <span class="quota-value" id="quotaValue">--</span>
                </div>
                <button class="settings-btn" id="settingsBtn" aria-label="Settings">
                    <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M12 15a3 3 0 1 0 0-6 3 3 0 0 0 0 6Z"/>
                        <path d="M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-2 2 2 2 0 0 1-2-2v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1-2-2 2 2 0 0 1 2-2h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 0-2.83 2 2 0 0 1 2.83 0l.06.06a1.65 1.65 0 0 0 1.82.33H9a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 2-2 2 2 0 0 1 2 2v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 0 2 2 0 0 1 0 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82V9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 2 2 2 2 0 0 1-2 2h-.09a1.65 1.65 0 0 0-1.51 1Z"/>
                    </svg>
                </button>
            </div>
        </header>

        <!-- Main Content -->
        <div class="main-content">
            <!-- Sidebar -->
            <aside class="sidebar">
                <div class="sidebar-section">
                    <h3>Model</h3>
                    <select class="model-selector" id="modelSelector">
                        <option value="mistral-7b">Mistral 7B</option>
                        <option value="llama2-13b">Llama 2 13B</option>
                        <option value="codegen-16b">CodeGen 16B</option>
                    </select>
                </div>

                <div class="sidebar-section">
                    <h3>Tier</h3>
                    <select class="tier-selector" id="tierSelector">
                        <option value="free">Free (10/month)</option>
                        <option value="basic">Basic (100/month)</option>
                        <option value="pro">Pro (1000/month)</option>
                        <option value="unlimited">Unlimited (Pay-per-use)</option>
                    </select>
                </div>

                <div class="sidebar-section">
                    <h3>Connection</h3>
                    <div class="connection-settings">
                        <label for="rpcUrl">RPC URL:</label>
                        <input type="text" id="rpcUrl" value="http://127.0.0.1:9944" class="connection-input">
                        
                        <label for="wsUrl">WebSocket URL:</label>
                        <input type="text" id="wsUrl" value="ws://127.0.0.1:9944" class="connection-input">
                    </div>
                </div>

                <div class="sidebar-section">
                    <button class="new-chat-btn" id="newChatBtn">New Chat</button>
                    <button class="export-btn" id="exportBtn">Export Chat</button>
                </div>

                <div class="sidebar-section">
                    <h3>Navigation</h3>
                    <div class="tab-buttons">
                        <button class="tab-btn active" data-tab="chat">Chat</button>
                        <button class="tab-btn" data-tab="staking">Staking</button>
                        <button class="tab-btn" data-tab="governance">Governance</button>
                    </div>
                </div>
            </aside>

            <!-- Main Content Area -->
            <div class="main-area">
                <!-- Chat Tab -->
                <div id="chatTab" class="tab-content active">
                    <div class="chat-messages" id="chatMessages">
                        <div class="welcome-message">
                            <h2>Welcome to AIGEN AI Playground</h2>
                            <p>Start chatting with AI models powered by the AIGEN blockchain. Select a model and tier, then type your message below.</p>
                            <div class="quick-actions">
                                <button class="quick-action" data-message="Hello! How can you help me today?">Hello!</button>
                                <button class="quick-action" data-message="Explain quantum computing in simple terms">Explain quantum computing</button>
                                <button class="quick-action" data-message="Write a Python function to calculate fibonacci numbers">Write Python code</button>
                            </div>
                        </div>
                    </div>

                    <div class="chat-input-container">
                        <div class="input-controls">
                            <label class="streaming-toggle">
                                <input type="checkbox" id="streamingToggle" checked>
                                <span>Streaming</span>
                            </label>
                            <div class="token-counter">
                                <span id="tokenCount">0</span> tokens
                            </div>
                        </div>
                        <div class="chat-input-wrapper">
                            <textarea 
                                id="chatInput" 
                                placeholder="Type your message here... (Shift+Enter for new line)"
                                rows="1"
                                maxlength="4000"
                            ></textarea>
                            <button class="send-btn" id="sendBtn" disabled>
                                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                    <line x1="22" y1="2" x2="11" y2="13"></line>
                                    <polygon points="22 2 15 22 11 13 2 9 22 2"></polygon>
                                </svg>
                            </button>
                        </div>
                    </div>
                </div>

                <!-- Staking Tab -->
                <div id="stakingTab" class="tab-content hidden">
                    <div class="staking-header">
                        <h2>Staking</h2>
                        <div class="stake-summary">
                            <div class="stat-card">
                                <label>Your Stake</label>
                                <span id="yourStake">0 AIGEN</span>
                            </div>
                            <div class="stat-card">
                                <label>Role</label>
                                <span id="stakeRole">None</span>
                            </div>
                            <div class="stat-card">
                                <label>Rewards Earned</label>
                                <span id="rewardsEarned">0 AIGEN</span>
                            </div>
                            <div class="stat-card">
                                <label>Wallet Balance</label>
                                <span id="walletBalance">-- AIGEN</span>
                            </div>
                        </div>
                    </div>
                    
                    <div class="staking-actions">
                        <div class="action-card">
                            <h3>Stake Tokens</h3>
                            <form id="stakeForm">
                                <input type="number" id="stakeAmount" placeholder="Amount (AIGEN)" min="1000" required>
                                <select id="stakeRoleSelect">
                                    <option value="Inference">Inference (min 1000)</option>
                                    <option value="Training">Training (min 5000)</option>
                                    <option value="Both">Both (min 5000)</option>
                                </select>
                                <button type="submit" class="btn-primary">Stake</button>
                            </form>
                        </div>
                        
                        <div class="action-card">
                            <h3>Unstake Tokens</h3>
                            <form id="unstakeForm">
                                <input type="number" id="unstakeAmount" placeholder="Amount (AIGEN)" min="1" required>
                                <button type="submit" class="btn-secondary">Unstake</button>
                            </form>
                        </div>
                        
                        <div class="action-card">
                            <h3>Claim Rewards</h3>
                            <p>Pending unstake: <span id="pendingUnstake">0 AIGEN</span></p>
                            <button id="claimBtn" class="btn-primary">Claim</button>
                        </div>
                    </div>
                </div>

                <!-- Governance Tab -->
                <div id="governanceTab" class="tab-content hidden">
                    <div class="governance-header">
                        <h2>Governance</h2>
                        <div class="voting-power">
                            <label>Your Voting Power:</label>
                            <span id="votingPower">0 AIGEN</span>
                        </div>
                    </div>
                    
                    <div class="governance-content">
                        <div class="proposals-list">
                            <h3>Active Proposals</h3>
                            <div id="proposalsList">
                                <p class="empty-state">Loading proposals...</p>
                            </div>
                        </div>
                        
                        <div class="proposal-details hidden" id="proposalDetails">
                            <h3>Proposal Details</h3>
                            <div id="proposalInfo"></div>
                            <div id="voteForm">
                                <h4>Cast Your Vote</h4>
                                <select id="voteChoice">
                                    <option value="Approve">Approve</option>
                                    <option value="Reject">Reject</option>
                                    <option value="Abstain">Abstain</option>
                                </select>
                                <textarea id="voteComment" placeholder="Optional comment"></textarea>
                                <button id="submitVoteBtn" class="btn-primary">Submit Vote</button>
                            </div>
                            <div id="voteTally"></div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Settings Modal -->
    <div class="modal" id="settingsModal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>Settings</h2>
                <button class="modal-close" id="modalClose">&times;</button>
            </div>
            <div class="modal-body">
                <div class="settings-section">
                    <h3>Connection</h3>
                    <label for="settingsRpcUrl">RPC URL:</label>
                    <input type="text" id="settingsRpcUrl" value="http://127.0.0.1:9944">
                    
                    <label for="settingsWsUrl">WebSocket URL:</label>
                    <input type="text" id="settingsWsUrl" value="ws://127.0.0.1:9944">
                </div>

                <div class="settings-section">
                    <h3>Wallet Configuration</h3>
                    <label for="walletAddress">Wallet Address (Public Key):</label>
                    <input type="text" id="walletAddress" placeholder="Derived from private key" readonly>
                    
                    <label for="walletPrivateKey">Private Key (64 bytes hex):</label>
                    <input type="password" id="walletPrivateKey" placeholder="Enter your private key">
                    <button id="generateKeyBtn" class="btn-secondary">Generate New Keypair</button>
                    
                    <div id="generatedKeys" class="hidden">
                        <p><strong>⚠️ Save these keys securely!</strong></p>
                        <label>Private Key:</label>
                        <input type="text" id="genPrivateKey" readonly>
                        <label>Public Key (Address):</label>
                        <input type="text" id="genPublicKey" readonly>
                    </div>
                </div>

                <div class="settings-section">
                    <h3>Model Parameters</h3>
                    <label for="maxTokens">Max Tokens: <span id="maxTokensValue">2048</span></label>
                    <input type="range" id="maxTokens" min="128" max="4096" value="2048" step="128">
                    
                    <label for="temperature">Temperature: <span id="temperatureValue">0.7</span></label>
                    <input type="range" id="temperature" min="0" max="2" value="0.7" step="0.1">
                </div>

                <div class="settings-section">
                    <h3>Theme</h3>
                    <label class="theme-toggle">
                        <input type="checkbox" id="themeToggle">
                        <span>Dark Mode</span>
                    </label>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn-secondary" id="resetSettingsBtn">Reset to Defaults</button>
                <button class="btn-primary" id="saveSettingsBtn">Save Settings</button>
            </div>
        </div>
    </div>

    <!-- Loading Overlay -->
    <div class="loading-overlay" id="loadingOverlay">
        <div class="loading-spinner"></div>
        <div class="loading-text">Connecting to AIGEN...</div>
    </div>

    <script src="../../dashboard/wallet.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/tweetnacl@1.0.3/nacl-fast.min.js"></script>
    <script src="app.js"></script>
</body>
</html>
